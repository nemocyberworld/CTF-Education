<h2 class="text-2xl font-bold mb-4">🩸 CSI CTF Forensics: Panda</h2>
<p class="text-gray-300 mb-4">A classic steganography + cryptography challenge involving comparing two panda images hidden inside a password-protected zip file.</p>

<ul class="list-disc ml-6 text-gray-400 space-y-2 mb-6">
  <li>Impact: Hidden flag extraction from binary differences</li>
  <li>Vector: Password-protected zip + altered image bytes</li>
  <li>PoC: <a href="./Forensics/CSI-CTF/Panda/panda.zip" target="_blank" class="text-blue-400 underline">Challenge Files</a></li>
</ul>

<h3 class="text-xl font-bold text-gray-100 mb-2">🔍 What is Panda?</h3>
<p class="text-gray-300 mb-4">
This challenge provided two panda images inside a password-protected zip. The trick was to first crack the zip, then compare the binary differences of the two images to reveal the flag.
</p>

<h3 class="text-xl font-bold text-gray-100 mb-2">🧪 Test Environment Requirements</h3>
<ul class="list-disc ml-6 text-gray-400 space-y-2 mb-6">
  <li><code>zip2john</code> and <code>john</code> (John the Ripper)</li>
  <li>Python 3 interpreter</li>
  <li>Basic file comparison knowledge</li>
</ul>

<h3 class="text-xl font-bold text-gray-100 mb-2">⚙️ Step 1: Crack the Zip</h3>
<pre class="bg-gray-900 text-green-400 text-sm p-4 rounded overflow-x-auto whitespace-pre-wrap">
zip2john panda.zip > hash.txt
john --wordlist=rockyou.txt hash.txt
</pre>

<h3 class="text-xl font-bold text-gray-100 mb-2">⚙️ Step 2: Extract Files</h3>
<p class="text-gray-300 mb-4">Inside the zip were two images: <code>panda.jpg</code> and <code>panda1.jpg</code>.</p>

<h3 class="text-xl font-bold text-gray-100 mb-2">⚙️ Step 3: Compare Images</h3>
<p class="text-gray-300 mb-2">A small Python script compares the two files byte by byte, printing the differences as ASCII characters.</p>
<pre class="bg-gray-900 text-green-400 text-sm p-4 rounded overflow-x-auto whitespace-pre-wrap">
print(''.join([chr(i) for i, j in zip(open('panda1.jpg', 'rb').read(), open('panda.jpg', 'rb').read()) if i!= j]))
</pre>

<h3 class="text-xl font-bold text-gray-100 mb-2">🚀 Step 4: The Flag</h3>
<pre class="bg-gray-900 text-blue-400 text-sm p-4 rounded overflow-x-auto whitespace-pre-wrap">
csictf{kung_fu_p4nd4}
</pre>

<h3 class="text-xl font-bold text-gray-100 mb-2">🛡️ Mitigation</h3>
<ul class="list-disc ml-6 text-gray-400 space-y-2 mb-6">
  <li>Always inspect encrypted archives for hidden stego payloads.</li>
  <li>Use automated comparison tools to speed up detection of differences.</li>
  <li>In real-world cases, hidden content could be malware instead of harmless flags.</li>
</ul>

<h3 class="text-xl font-bold text-gray-100 mb-2">🧠 Summary for Beginners</h3>
<p class="text-gray-300 mb-4">
This challenge combined password cracking with binary diffing. After unlocking the zip, comparing two images revealed the flag in the differing bytes. Key lesson: Always suspect file pairs in CTFs—they often hide differences as data.
</p>

<p class="text-gray-300 italic mb-4">⚠️ Remember: Techniques used in CTFs (zip cracking, byte diffs) can also uncover real forensic evidence.</p>

<hr class="border-gray-700 my-6">

<h2 class="text-2xl font-bold mb-4">🔍 How the Technique Works</h2>
<p class="text-gray-300 mb-4">
The script iterates over both files simultaneously. Whenever a byte differs between <code>panda.jpg</code> and <code>panda1.jpg</code>, it prints the ASCII character of the differing byte. The differences collectively spell out the flag.
</p>

<h3 class="text-xl font-semibold text-white mb-2">Key Steps in the Process</h3>
<ul class="list-decimal ml-6 text-gray-400 space-y-2 mb-6">
  <li><strong>Crack:</strong> Recover the zip password with <code>zip2john</code>.</li>
  <li><strong>Extract:</strong> Get both panda images.</li>
  <li><strong>Compare:</strong> Run Python diff script to reveal hidden flag.</li>
</ul>

<h3 class="text-xl font-semibold text-white mb-2">📎 Code Snippet Reference</h3>
<pre class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-auto text-sm">
print(''.join([chr(i) for i, j in zip(open('panda1.jpg', 'rb').read(),
open('panda.jpg', 'rb').read()) if i!= j]))
</pre>

<p class="text-gray-400 mb-6">
This worked because the challenge setter deliberately introduced byte differences in the images encoding the flag.
</p>

<h2 class="text-2xl font-bold mb-4 mt-10">💀 Exploit Variant</h2>
<p class="text-gray-300 mb-4">
Other steganography CTFs may use EXIF metadata, appended archives, or pixel-level manipulations instead of direct byte differences.
</p>

<h3 class="text-xl font-semibold text-white mb-2">📌 How It Works</h3>
<ul class="list-decimal ml-6 text-gray-400 space-y-2 mb-6">
  <li>Variant 1: Hide data in EXIF tags.</li>
  <li>Variant 2: Append encrypted archive to an image.</li>
  <li>Variant 3: Encode flag in pixel values (LSB stego).</li>
</ul>

<h3 class="text-xl font-semibold text-white mb-2">🧠 Important Notes</h3>
<ul class="list-disc ml-6 text-gray-400 space-y-2 mb-6">
  <li>This was a beginner-friendly challenge.</li>
  <li>Always try <code>strings</code>, <code>binwalk</code>, and <code>xxd</code> for alternatives.</li>
  <li>Different stego methods = different extraction strategies.</li>
</ul>

<h3 class="text-xl font-semibold text-white mb-2">📎 Code Reference</h3>
<pre class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-auto text-sm">
// Example with binwalk
binwalk panda1.jpg
</pre>

<p class="text-gray-400">
Reference link: <a href="https://csictf.com/" target="_blank" class="text-blue-400 underline">CSI CTF</a>
</p>
