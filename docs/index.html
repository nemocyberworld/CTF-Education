<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CTF Tools & Challenge Explanations</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white font-sans flex flex-col min-h-screen">

  <!-- Header -->
  <header class="bg-gray-800 p-4 text-center shadow-md">
    <h1 class="text-3xl font-bold">🏴‍☠️ CTF Tools & Writeups Hub</h1>
    <p class="text-gray-400">
      by <a href="https://github.com/nemocyberworld">Captain Nemo</a> |
      <a href="https://hacktolive.net/">HackToLive</a>
    </p>
  </header>

  <!-- Layout -->
  <div class="flex flex-1 overflow-hidden">
    <!-- Sidebar -->
    <aside class="w-72 bg-gray-800 p-4 overflow-y-auto border-r border-gray-700">
      <h2 class="text-lg font-semibold mb-4">Categories</h2>

      <input
        type="text"
        id="searchInput"
        placeholder="Search…"
        class="w-full mb-4 px-3 py-2 rounded bg-gray-700 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500"
      />

      <ul id="categoryList" class="space-y-2 text-sm"></ul>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 p-6 overflow-y-auto">
      <nav id="breadcrumb" class="text-xs text-gray-400 mb-3"></nav>
      <div id="walkthroughContent" class="bg-gray-800 p-6 rounded-xl shadow-md">
        <h2 class="text-2xl font-bold mb-4">🧠 Welcome to Your Hacking Arsenal</h2>
        <p class="text-gray-300 mb-4">
          This platform documents all types of hacking tools and techniques. Offensive Security focused.
        </p>

        <h3 class="text-xl font-semibold mt-6 mb-2">📂 Main Categories</h3>
        <ul id="categoryOverview" class="list-disc ml-6 text-gray-400 space-y-1"></ul>
      </div>
    </main>
  </div>

  <footer class="bg-gray-800 text-center text-gray-400 text-sm py-3 px-4 mt-auto border-t border-gray-700 select-none">
    <p>
      © 2025 Captain Nemo · CTF education & research.
      Visit <a href="https://hacktolive.net/" class="text-purple-400 underline">HackToLive</a>
    </p>
  </footer>

<script>
/* -----------------------------
   Data model: unlimited nesting
   ----------------------------- */
const catalog = [
  {
    title: "Forensics",
    children: [
      {
        title: "CSI CTF",
        children: [
          { title: "Gradient Sky", path: "Forensics/CSI-CTF/Gradient-Sky/index.html" },
          { title: "Panda", path: "Forensics/CSI-CTF/Panda/index.html" },
          { title: "Unseen", path: "Forensics/CSI-CTF/Unseen/index.html" }
        ]
      },
      
    ]
  },
  // Example extra tier:
  // {
  //   title: "Web",
  //   children: [
  //     {
  //       title: "XSS",
  //       children: [
  //         { title: "Reflected XSS Lab", path: "Web/XSS/reflected.html" },
  //         { title: "Stored XSS Lab", path: "Web/XSS/stored.html" }
  //       ]
  //     }
  //   ]
  // }
];

const categoryList = document.getElementById("categoryList");
const walkthroughContent = document.getElementById("walkthroughContent");
const categoryOverview = document.getElementById("categoryOverview");
const searchInput = document.getElementById("searchInput");
const breadcrumb = document.getElementById("breadcrumb");

/* -----------------------------
   Helpers
   ----------------------------- */
function isLeaf(node){ return !!node.path && !node.children; }

function countLeaves(node){
  if (isLeaf(node)) return 1;
  return (node.children || []).reduce((a,c)=>a+countLeaves(c),0);
}

function renderOverview(tree){
  categoryOverview.innerHTML = "";
  tree.forEach(node=>{
    const li = document.createElement("li");
    li.textContent = `${node.title} (${countLeaves(node)})`;
    categoryOverview.appendChild(li);
  });
}

function makeSummary(title, count){
  return `
    <summary class="cursor-pointer px-3 py-2 rounded-md hover:bg-gray-700 font-semibold flex items-center justify-between">
      <span>${title}</span>
      <span class="text-xs text-gray-400">${count}</span>
    </summary>
  `;
}

function updateBreadcrumb(pathArr){
  if (!pathArr || pathArr.length === 0){
    breadcrumb.innerHTML = "";
    return;
  }
  breadcrumb.innerHTML = pathArr.map((p,i)=>`
    <span class="${i<pathArr.length-1 ? 'text-gray-500' : 'text-gray-300'}">${p}</span>
    ${i<pathArr.length-1 ? '<span class="mx-1">/</span>' : ''}
  `).join("");
}

/* -----------------------------------------
   Recursive tree builder for any depth
   ----------------------------------------- */
function buildTree(nodes, container, open=false, trail=[]){
  container.innerHTML = "";
  nodes.forEach(node=>{
    const li = document.createElement("li");

    if (isLeaf(node)){
      li.innerHTML = `
        <button class="text-left w-full px-2 py-1 hover:bg-gray-700 rounded"
                title="${trail.concat(node.title).join(' / ')}"
                onclick='loadWalkthrough(${JSON.stringify(node.path)},"${trail.concat(node.title).join(' > ')}")'>
          ${node.title}
        </button>`;
    } else {
      const details = document.createElement("details");
      if (open) details.setAttribute("open","");

      details.className = "group";
      details.innerHTML = makeSummary(node.title, countLeaves(node));

      const ul = document.createElement("ul");
      ul.className = "pl-4 mt-2 space-y-1 text-sm";
      details.appendChild(ul);

      // recurse
      buildTree(node.children || [], ul, open, trail.concat(node.title));
      li.appendChild(details);
    }

    container.appendChild(li);
  });
}

/* -----------------------------------------
   Search (matches leaves & folders)
   Keeps ancestors of matches expanded
   ----------------------------------------- */
function filterTree(nodes, query){
  if (!query) return nodes;

  const q = query.toLowerCase();
  const out = [];

  nodes.forEach(node=>{
    const titleMatch = node.title.toLowerCase().includes(q);

    if (isLeaf(node)){
      if (titleMatch) out.push(node);
    } else {
      const filteredKids = filterTree(node.children || [], q);
      if (titleMatch || filteredKids.length){
        out.push({ ...node, children: filteredKids.length ? filteredKids : node.children });
      }
    }
  });

  return out;
}

/* -----------------------------------------
   Load content + set breadcrumb
   ----------------------------------------- */
async function loadWalkthrough(path, crumb){
  try {
    const res = await fetch(path);
    if (!res.ok) throw new Error("File not found");
    const html = await res.text();
    walkthroughContent.innerHTML = html;
    updateBreadcrumb(crumb.split(" > "));
  } catch (err) {
    walkthroughContent.innerHTML = `<p class="text-red-400">⚠️ Error loading content: ${err.message}</p>`;
  }
}

/* -----------------------------------------
   Init
   ----------------------------------------- */
function refreshUI(tree, open=false){
  buildTree(tree, categoryList, open);
  renderOverview(tree);
}

refreshUI(catalog);

searchInput.addEventListener("input", () => {
  const q = searchInput.value.trim();
  if (!q){
    refreshUI(catalog);
    updateBreadcrumb([]);
    return;
  }
  const filtered = filterTree(catalog, q);
  refreshUI(filtered, true);  // open matched branches
});
</script>

</body>
</html>
